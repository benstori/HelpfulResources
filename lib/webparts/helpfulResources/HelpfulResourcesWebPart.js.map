{"version":3,"sources":["webparts/helpfulResources/HelpfulResourcesWebPart.ts"],"names":[],"mappings":"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","file":"webparts/helpfulResources/HelpfulResourcesWebPart.js","sourcesContent":["import { Version } from '@microsoft/sp-core-library';\r\nimport { sp, Items, ItemVersion, Web } from \"@pnp/sp\";\r\n\r\nimport {\r\n  BaseClientSideWebPart,\r\n  IPropertyPaneConfiguration,\r\n  PropertyPaneTextField\r\n} from '@microsoft/sp-webpart-base';\r\n\r\nimport {\r\n  Environment,\r\n  EnvironmentType\r\n } from '@microsoft/sp-core-library';\r\n\r\nimport { escape } from '@microsoft/sp-lodash-subset';\r\n\r\nimport styles from './HelpfulResourcesWebPart.module.scss';\r\nimport * as strings from 'HelpfulResourcesWebPartStrings';\r\n\r\nimport {\r\n  SPHttpClient,\r\n  SPHttpClientResponse   \r\n } from '@microsoft/sp-http';\r\n\r\n export interface ISPLists {\r\n  value: ISPList[];\r\n }\r\n\r\n export interface ISPList {\r\n  Title: string; // this is the department name in the List\r\n  Id: string;\r\n  AnncURL:string;\r\n  DeptURL:string;\r\n  CalURL:string;\r\n  a85u:string; // this is the LINK URL\r\n }\r\n\r\n  //global vars\r\n  var userDept = \"\";\r\n\r\nexport interface IHelpfulResourcesWebPartProps {\r\n  description: string;\r\n}\r\n\r\nexport default class HelpfulResourcesWebPart extends BaseClientSideWebPart<IHelpfulResourcesWebPartProps> {\r\n\r\n  // main promoise method, 1st we get the department, second chain is a REST Call to query the list\r\n// third we get the list data and figure out the document libraries\r\ngetuser = new Promise((resolve,reject) => {\r\n  // SharePoint PnP Rest Call to get the User Profile Properties\r\n  return sp.profiles.myProperties.get().then(function(result) {\r\n    var props = result.UserProfileProperties;\r\n    var propValue = \"\";\r\n    var userDepartment = \"\";\r\n\r\n    props.forEach(function(prop) {\r\n      //this call returns key/value pairs so we need to look for the Dept Key\r\n      if(prop.Key == \"Department\"){\r\n        // set our global var for the users Dept.\r\n        userDept += prop.Value;\r\n      }\r\n    });\r\n    return result;\r\n  }).then((result) =>{\r\n    this._getListData().then((response) =>{\r\n      this._renderList(response.value);\r\n    });\r\n  });\r\n\r\n});\r\n\r\n  public render(): void {\r\n    this.domElement.innerHTML = `\r\n      <div class=\"${ styles.helpfulResources }\">\r\n        <div class=\"${ styles.container }\">\r\n          <div class=\"${ styles.row }\">\r\n            <div class=\"${ styles.column }\">\r\n              <span class=\"${ styles.title }\">Welcome to SharePoint!</span>\r\n              <p class=\"${ styles.subTitle }\">Customize SharePoint experiences using Web Parts.</p>\r\n              <p class=\"${ styles.description }\">${escape(this.properties.description)}</p>\r\n              <a href=\"https://aka.ms/spfx\" class=\"${ styles.button }\">\r\n                <span class=\"${ styles.label }\">Learn more</span>\r\n              </a>\r\n            </div>\r\n            <h1>Helpful Resources</h1>\r\n            <h3><div id=\"HelpfulRes\"/></h3>\r\n          </div>\r\n        </div>\r\n      </div>`;\r\n  }\r\n\r\n  protected get dataVersion(): Version {\r\n    return Version.parse('1.0');\r\n  }\r\n\r\n    // main REST Call to the list...passing in the deaprtment into the call to \r\n  //return a single list item\r\n  public _getListData(): Promise<ISPLists> {  \r\n    return this.context.spHttpClient.get(`https://girlscoutsrv.sharepoint.com/_api/web/lists/GetByTitle('TeamDashboardSettings')/Items?$filter=Title eq '`+ userDept +`'`, SPHttpClient.configurations.v1)\r\n      .then((response: SPHttpClientResponse) => {\r\n        return response.json();\r\n      });\r\n   }\r\n\r\n   private _renderList(items: ISPList[]): void {\r\n    let html: string = '';\r\n    let libHTML: string ='';\r\n  \r\n    var siteURL = \"\";\r\n    //list name\r\n    var helpfulResources =  \"\";\r\n    // items in the list\r\n    var hrItems = \"\";\r\n\r\n    items.forEach((item: ISPList) => {\r\n      siteURL = item.DeptURL;\r\n      helpfulResources = item.a85u;\r\n    });\r\n    //1st we need to override the current web to go to the department sites web\r\n    const w = new Web(\"https://girlscoutsrv.sharepoint.com\" + siteURL);\r\n    \r\n    // then use PnP to query the list\r\n    w.lists.getByTitle(helpfulResources).items\r\n    .get()\r\n    .then((data) => {\r\n      console.log(data);\r\n\r\n      for (var x = 0; x < data.length; x++){\r\n        //console.log(data[x].URL);\r\n        console.log(data[x].URL.Url);\r\n        console.log(data[x].URL.Description);\r\n        //hrItems += data[x].URL + '\\r\\n';\r\n       // libHTML += `<p>${hrItems.toString()}</p>`;\r\n      }\r\n      //document.getElementById(\"HelpfulRes\").innerText = hrItems;\r\n  }).catch(e => { console.error(e); });\r\n\r\n    const listContainer: Element = this.domElement.querySelector('#ListItems');\r\n    listContainer.innerHTML = html;\r\n  }\r\n\r\n  // this is required to use the SharePoint PnP shorthand REST CALLS\r\n  public onInit():Promise<void> {\r\n    return super.onInit().then (_=> {\r\n      sp.setup({\r\n        spfxContext:this.context\r\n      });\r\n    });\r\n  }\r\n\r\n  protected getPropertyPaneConfiguration(): IPropertyPaneConfiguration {\r\n    return {\r\n      pages: [\r\n        {\r\n          header: {\r\n            description: strings.PropertyPaneDescription\r\n          },\r\n          groups: [\r\n            {\r\n              groupName: strings.BasicGroupName,\r\n              groupFields: [\r\n                PropertyPaneTextField('description', {\r\n                  label: strings.DescriptionFieldLabel\r\n                })\r\n              ]\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n    };\r\n  }\r\n}\r\n"],"sourceRoot":"..\\..\\..\\src"}